# 应用配置
server.port=58080
spring.application.name=tcm-project

# Spring Cloud配置
spring.cloud.loadbalancer.ribbon.enabled=false
spring.cloud.discovery.enabled=true

# 服务注册中心配置 (如果使用Eureka)
# eureka.client.service-url.defaultZone=${EUREKA_SERVER_URL:http://localhost:8761/eureka}
# eureka.instance.prefer-ip-address=true

# 微信小程序相关配置
wechat.appid=${WECHAT_APPID:your_appid_here}
wechat.secret=${WECHAT_SECRET:your_secret_here}
wechat.token=${WECHAT_TOKEN:your_token_here}
wechat.aeskey=${WECHAT_AESKEY:your_aeskey_here}

# PostgreSQL数据库配置
spring.datasource.url=jdbc:postgresql://localhost:5432/tcm_hospital
spring.datasource.username=admin
spring.datasource.password=password
spring.datasource.driver-class-name=org.postgresql.Driver

# JPA配置
spring.jpa.database-platform=org.hibernate.dialect.PostgreSQLDialect
spring.jpa.hibernate.ddl-auto=update
spring.jpa.show-sql=true
spring.jpa.properties.hibernate.format_sql=true

# 连接池配置
spring.datasource.hikari.maximum-pool-size=20
spring.datasource.hikari.minimum-idle=5
spring.datasource.hikari.idle-timeout=300000
spring.datasource.hikari.max-lifetime=600000

# AI大模型服务配置 (使用服务发现或直接URL)
ai.model.service.url=${AI_MODEL_SERVICE_URL:http://localhost:7578}
ai.model.service.name=ai-model-service
ai.model.service.timeout=${AI_MODEL_SERVICE_TIMEOUT:10000}
ai.model.api.key=${AI_MODEL_API_KEY:EMPTY}

# OpenFeign配置
feign.client.config.default.connectTimeout=10000
feign.client.config.default.readTimeout=15000
feign.compression.request.enabled=true
feign.compression.response.enabled=true

# 日志配置
logging.level.com.tcm=DEBUG
logging.level.org.springframework.web=DEBUG
logging.level.org.springframework.cloud.openfeign=DEBUG
logging.level.org.hibernate.SQL=DEBUG
logging.level.org.hibernate.type.descriptor.sql.BasicBinder=TRACE

# 文件上传配置
spring.servlet.multipart.max-file-size=10MB
spring.servlet.multipart.max-request-size=10MB

# Jackson配置以处理懒加载和大整数
spring.jackson.serialization.fail-on-empty-beans=false
# 将大整数序列化为字符串以避免JavaScript精度问题
spring.jackson.serialization.write-bigdecimal-as-plain=true
# 使用更精确的数字解析器
spring.jackson.parser.USE_FAST_BIG_NUMBER_PARSER=true

# 处理空字符串为null
spring.jpa.properties.hibernate.null_precedence=high

# CORS配置
# 允许前端跨域请求
spring.web.cors.allowed-origins=http://localhost:8080,http://127.0.0.1:8080
spring.web.cors.allowed-methods=GET,POST,PUT,DELETE,OPTIONS
spring.web.cors.allowed-headers=*
spring.web.cors.allow-credentials=true